<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Keykicks</title>
    <style>
        /* ---------- HEADER & MARQUEE ---------- */
        .header-marquee { flex-grow: 1; overflow: hidden; white-space: nowrap; position: relative; height: 100%; display: flex; align-items: center; margin: 0 20px; }
        .marquee-text { display: inline-block; padding-left: 100%; color: #fff; font-size: 0.85rem; letter-spacing: 1px; animation: marqueeScroll 12s linear infinite; }
        @keyframes marqueeScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* ---------- GLOBAL ---------- */
        body { margin: 0; font-family: Arial, sans-serif; background-color: #fff; color: #222; overflow-x: hidden; }
        p { margin: 70px auto; padding: 0 135px; font-family: 'Roboto', sans-serif; font-size: 20px; line-height: 1.4; max-width: 1000px; }

        header { background-color: #111; color: #fff; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; height: 40px; width: 100%; box-sizing: border-box; position: relative; z-index: 1000; }
        .header-left, .header-right { display: flex; align-items: center; gap: 10px; height: 100%; }
        .header-left a img { width: 20px; height: 20px; filter: invert(1); cursor: pointer; display: block; }
        
        .search-bar { display: flex; align-items: center; height: 26px; }
        .search-bar input { padding: 0 8px; border-radius: 4px 0 0 4px; border: none; font-size: 0.85rem; height: 100%; width: 120px; }
        .search-bar button { background-color: #fff; color: #111; border: none; padding: 0 10px; border-radius: 0 4px 4px 0; cursor: pointer; font-weight: bold; height: 100%; }

        /* ---------- VIDEO SECTION ---------- */
        .video-section { width: 100%; height: calc(85vh - 45px); background-color: #000; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
        .video-section video { width: 100%; height: 100%; object-fit: cover; }
        .overlay-image { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 50%; pointer-events: none; }

        /* ---------- SHOP & CATEGORIES ---------- */
        main { padding: 2rem; max-width: 1000px; margin: 0 auto; }
        .categories { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 50px; }
        .category { background: #fff; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); overflow: hidden; cursor: pointer; display: flex; flex-direction: column; align-items: center; transition: transform 0.3s; }
        .category:hover { transform: translateY(-5px); }
        .category img { width: 100%; height: 180px; object-fit: contain; padding: 5px; }
        .category-title { text-align: center; padding: 1rem; background-color: #111; color: #fff; width: 100%; }

        /* ---------- MODALS (CART & CHECKOUT) ---------- */
        .shop-overlay, .checkout-step-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; display: none; flex-direction: column; overflow-y: auto; z-index: 5000; padding: 2rem; box-sizing: border-box; }
        .checkout-step-modal { top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 500px; height: auto; max-height: 85vh; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
        
        #cart-overlay { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 450px; background: #fff; padding: 20px; border-radius: 10px; z-index: 5000; display: none; flex-direction: column; box-shadow: 0 5px 15px rgba(0,0,0,0.4); }
        #cart-bg, #popup-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 4000; display: none; }

        .checkout-btn { width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1.1rem; }
        .close-btn, .modal-close-btn { position: absolute; top: 15px; left: 25px; width: 25px; cursor: pointer; z-index: 1001; }
    </style>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>

<header>
    <div class="header-left">
        <a href="#" onclick="openCart(); return false;"><img src="icons/shopping-cart.png" alt="Warenkorb"></a>
    </div>
    <div class="header-marquee">
        <div class="marquee-text">This Site is under development. No orders possible. Please click the "Notify me button" to stay updated.</div>
    </div>
    <div class="header-right">
        <form class="search-bar" id="searchForm">
            <input type="text" id="searchInput" placeholder="Suchen..." required>
            <button type="submit">Suche</button>
        </form>
    </div>
</header>

<section class="video-section">
    <video autoplay muted loop><source src="test2.mp4" type="video/mp4"></video>
    <img src="keykickslogowhite.png" alt="Logo" class="overlay-image">
</section>

<main>
    <p><b>Keykicks</b> bietet stylische Schlüsselanhänger mit Liebe zum Detail. <b>Hol dir deinen Eyecatcher!</b></p>
    
    <div class="categories">
        <div class="category" onclick="openShop('sneaker')">
            <img src="icons/sneakers.png" alt="Sneaker">
            <div class="category-title">Sneaker</div>
        </div>
        <div class="category" onclick="openShop('comic')">
            <img src="icons/theater.png" alt="Comic">
            <div class="category-title">Comic</div>
        </div>
        <div class="category" onclick="openShop('other')">
            <img src="icons/others.png" alt="Other">
            <div class="category-title">Other</div>
        </div>
    </div>
</main>

<div id="shop-overlay" class="shop-overlay">
    <img src="icons/close.png" class="close-btn" onclick="closeShop()">
    <h2 id="shop-title" style="text-align:center;">Shop</h2>
    <div id="sneaker-items" class="shop-content" style="display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.5rem;"></div>
    <div id="comic-items" class="shop-content" style="display:none;"></div>
    <div id="other-items" class="shop-content" style="display:none;"></div>
</div>

<div id="cart-bg" onclick="closeCart()"></div>
<div id="cart-overlay">
    <h3>Warenkorb</h3>
    <div id="cart-items-container"></div>
    <p>Gesamt: <span id="cart-total">€0,00</span></p>
    <button class="checkout-btn" onclick="openAddressModal()">Zur Kasse</button>
</div>

<div id="checkout-modal-address" class="checkout-step-modal">
    <h3>1. Versandadresse</h3>
    <form id="checkout-form-backend" action="https://formspree.io/f/DEINE_ID" method="POST">
        <input type="email" name="email" placeholder="E-Mail" required style="width:100%; margin-bottom:10px; padding:8px;">
        <input type="text" name="name" placeholder="Vollständiger Name" required style="width:100%; margin-bottom:10px; padding:8px;">
        <input type="text" name="address" placeholder="Straße / Hausnr." required style="width:100%; margin-bottom:10px; padding:8px;">
        <input type="text" name="city" placeholder="Stadt" required style="width:100%; margin-bottom:10px; padding:8px;">
        
        <input type="hidden" name="Warenkorb_Details" id="cart-data-input">
        <input type="hidden" name="Gesamtpreis" id="total-price-input">
        
        <button type="submit" class="checkout-btn">Bestellung abschicken</button>
    </form>
</div>

<script>
    let cart = JSON.parse(localStorage.getItem('keykicksCart')) || [];
    let allProductsData = { sneaker: [], comic: [], other: [] };

    // PRODUKTE LADEN [cite: 117]
    async function loadProducts() {
        const res = await fetch('https://raw.githubusercontent.com/pfundbo81/website-keykicks/main/products.json');
        const data = await res.json();
        allProductsData = data;
        renderProducts();
    }

    function renderProducts() {
        ['sneaker', 'comic', 'other'].forEach(cat => {
            const cont = document.getElementById(cat + '-items');
            if (!cont) return;
            cont.innerHTML = '';
            allProductsData[cat]?.forEach(p => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'category'; // Nutzt gleiches Design
                itemDiv.style.padding = "10px";
                itemDiv.innerHTML = `
                    <img src="${p.image}">
                    <b>${p.name}</b>
                    <p>${p.price}</p>
                    <button onclick="addToCart(${JSON.stringify(p).replace(/"/g, '&quot;')})" style="cursor:pointer; background:#111; color:#fff; border:none; padding:5px 10px; border-radius:4px;">Hinzufügen</button>
                `;
                cont.appendChild(itemDiv);
            });
        });
    }

    // BACKEND LOGIK: WARENKORB SENDEN 
    document.getElementById('checkout-form-backend').onsubmit = function(e) {
        document.getElementById('cart-data-input').value = JSON.stringify(cart);
        document.getElementById('total-price-input').value = document.getElementById('cart-total').textContent;
        // Formular wird nun an Formspree gesendet
    };

    function openShop(cat) {
        document.getElementById('shop-overlay').style.display = 'flex';
        ['sneaker', 'comic', 'other'].forEach(c => {
            document.getElementById(c + '-items').style.display = (c === cat) ? 'grid' : 'none';
        });
    }

    function closeShop() { document.getElementById('shop-overlay').style.display = 'none'; }
    
    function openCart() { 
        document.getElementById('cart-bg').style.display = 'block';
        document.getElementById('cart-overlay').style.display = 'flex';
        renderCart();
    }

    function closeCart() { 
        document.getElementById('cart-bg').style.display = 'none';
        document.getElementById('cart-overlay').style.display = 'none';
    }

    function addToCart(p) {
        cart.push(p);
        localStorage.setItem('keykicksCart', JSON.stringify(cart));
        alert(p.name + " hinzugefügt!");
    }

    function renderCart() {
        const container = document.getElementById('cart-items-container');
        container.innerHTML = cart.map(item => `<div>${item.name} - ${item.price}</div>`).join('');
        // Preisberechnung hier (vereinfacht)
        document.getElementById('cart-total').textContent = "Berechnet beim Checkout";
    }

    function openAddressModal() {
        closeCart();
        document.getElementById('checkout-modal-address').style.display = 'block';
    }

    loadProducts();
</script>
</body>
</html>
